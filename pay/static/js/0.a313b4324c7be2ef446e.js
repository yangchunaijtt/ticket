webpackJsonp([0],{"4E3S":function(t,e){},ga3y:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("Au9i"),o=a("+k7n"),i={name:"pay",components:{"mt-header":n.Header,"mt-button":n.Button},data:function(){return{eid:"",canpay:!0,remain_time:"00:00",price:0,roomname:"",startDate:"",createtime:"d",timid:0,where:"",openid:"",userphone:"",secret:"",userid:"",sign:"",guestIp:"",orderno:""}},created:function(){this.where=this.$cookie.get("WHERE"),this.openid=this.$cookie.get("WXOPID"),this.userphone=this.$cookie.get("gdmobileuserphone"),this.secret=this.$cookie.get("usersecret"),this.userid=this.$cookie.get("USERIDGDLY")},mounted:function(){},methods:{countdown:function(){var t=new Date,e=Date.parse(t),a=(this.createtime-e)/1e3;if(!(a>0))return clearInterval(this.timid),Object(n.Toast)("订单已经超时，请重新下单"),this.canpay=!1,window.location.href="../hotel/","";var o=parseInt(a/60),i=parseInt(a%60);console.log(o+":"+i),0==o&&0==i&&clearInterval(this.timid),o=o>=10?o:"0"+o,i=i>=10?i:"0"+i,this.remain_time=o+":"+i},Topay:function(){var t="";t="m.wandaly.net"==location.hostname?"http://m.wandaly.net/transportation/pay/html/hotelpaysuccess.html":"http://m.czgdly.com/transportation/pay/html/hotelpaysuccess.html",t="http://"+window.location.host+"/transportation/pay/html/hotelpaysuccess.html",BC.click({title:"酒店预定",amount:parseInt(100*this.price),out_trade_no:this.orderno,sign:this.sign,return_url:t,optional:{contactId:this.$cookie.get("USERIDGDLY"),contactSource:this.where,orderId:this.eid},analysis:{ip:this.guestIp},openid:this.openid},{wxJsapiFinish:function(e){"get_brand_wcpay_request:ok"==e.err_msg&&(window.location.href=t)}})}},beforeRouteLeave:function(t,e,a){console.log("离开的时候"),a(function(t){clearInterval(t.timid)})},beforeRouteEnter:function(t,e,a){n.Indicator.open(),console.log("支付页面",t.query);var i=t.query.AffiliateConfirmationId,r=t.query.OrderId,s=t.query.price,c="";c="m.wandaly.net"==location.hostname?"http://m.czgdly.com/transportation/gdtrain/Beecloud/getsign.asp":"http://m.czgdly.com/transportation/airplane/Beecloud/getsign.asp";var l,p;o.a.all([o.a.get("http://m.czgdly.com/transportation/airplane/beecloud/getCurrentIp.asp"),(l="酒店预定",p=i,o.a.get(c,{params:{title:l,amount:parseInt(100*s),orderno:p}}))]).then(o.a.spread(function(e,o){console.log("支付页面的"),console.log("ip",e.data),console.log("sign",o),n.Indicator.close(),a(function(a){n.Indicator.close(),a.eid=r,a.orderno=i,a.sign=o.data,a.guestIp=e.data,a.startDate=t.query.startDate,a.price=t.query.price,a.roomname=t.query.roomname,a.createtime=parseInt(t.query.createtime),console.log("时间",a.createtime),a.timid=setInterval(function(){a.countdown()},1e3)})}))}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pay"},[a("mt-header",{attrs:{fixed:"",title:"支付订单"}}),t._v(" "),a("div",{staticClass:"paycontent"},[a("div",{staticClass:"paynum"},[a("div",{staticClass:"pay-time"},[t._v("\n        支付剩余时间 "+t._s(t.remain_time)+"\n      ")]),t._v(" "),a("div",{staticClass:"pay-price"},[a("span",[t._v("￥")]),t._v(" "),a("span",[t._v(t._s(t.price))])]),t._v(" "),a("div",{staticClass:"bedtitle"},[a("span",[t._v(t._s(t.roomname))]),t._v(" "),a("span",[t._v(t._s(t.startDate))]),t._v(" "),a("span",[t._v("入住")])])])]),t._v(" "),t.canpay?a("div",{staticClass:"paybutton"},[a("mt-button",{attrs:{type:"primary",size:"large"},on:{click:t.Topay}},[t._v("支付￥"+t._s(t.price))])],1):t._e()],1)},staticRenderFns:[]};var s=a("VU/8")(i,r,!1,function(t){a("4E3S")},null,null);e.default=s.exports}});
//# sourceMappingURL=0.a313b4324c7be2ef446e.js.map