webpackJsonp([1],{G5tF:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("7+uW"),s={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var i=n("VU/8")({name:"app"},s,!1,function(e){n("hgYC")},null,null).exports,a=n("/ocq"),r=n("Xxa5"),c=n.n(r),u=n("exGp"),l=n.n(u),d=n("mtWM"),p=n.n(d),g=n("Au9i"),f=n.n(g),h=this,m={name:"payinfo",data:function(){return{paytitle:"",orderinfo:null,openid:"",mainorderno:"",paytype:"",price:0,planeinfo:[],peopleinfo:[],out_trade_no:"",sign:"",guestIp:"",where:"11",userphone:"",secret:"",userid:""}},components:{"mt-button":g.Button,"mt-heard":g.Header},computed:{havinsurance:function(){return null!=this.orderinfo&&(null!=this.orderinfo.InsuranceVo&&this.orderinfo.InsuranceVo.length>0)},passengerInfo:function(){if(null!=this.orderinfo)return this.orderinfo.orderBookingPassengerInfos},orderBookingPassengerVos:function(){if(null!=this.orderinfo)return this.orderinfo.orderDetailPassengerVos},insuranceName:function(){return this.orderinfo.orderBookingPassengerVos[0].insuranceVos.length>0?this.orderinfo.orderBookingPassengerVos[0].insuranceVos[0].insuranceName:""},insurancePrice:function(){return this.orderinfo.orderBookingPassengerVos[0].insuranceVos.length>0?this.orderinfo.orderBookingPassengerVos[0].insuranceVos[0].eachInsurancePrice:""}},methods:{getIdCardType:function(e){switch(e){case"1":return"身份证";case"2":return"儿童无证件";case"3":return"港澳通行证";case"4":return"台湾通行证";case"5":return"护照"}},clickPay:function(){var e;e="http://"+window.location.host+"/transportation/pay/html/trainpaysuccess.html",BC.click({title:this.paytitle,amount:parseInt(100*this.price),out_trade_no:this.out_trade_no,sign:this.sign,return_url:e,need_ali_guide:!0,optional:{customerId:this.$cookie.get("USERIDGDLY"),customerSource:this.where,orderNo:this.mainorderno,changeOrderId:0,refundId:0,ticketSerialNo:""},analysis:{ip:this.guestIp},openid:this.openid},{wxJsapiFinish:function(t){"get_brand_wcpay_request:ok"==t.err_msg&&(window.location.href=e)}})}},beforeRouteEnter:function(e,t,n){l()(c.a.mark(function t(){var o,s,i,a,r,u,l,d,f,m,v,_,b,y,k,w,P;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=function(e){var t,n=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(n))?unescape(t[2]):null},s=function(e,t,n,o,s){return p.a.get("http://58.216.175.118:86/api/LvmamaTrainTickets/TrainLocalOrders/GetTrainOrderByNo/"+e+"?token="+t+"|"+n+"|"+o+"|"+s)},i=e.query.partnerOrderNo,a=o("USERIDGDLY"),r=o("usersecret"),u=o("gdmobileuserphone"),l=o("WHERE"),t.next=9,s(i,a,r,u,l);case 9:d=t.sent,f=d.data,m="http://m.czgdly.com/transportation/airplane/Beecloud/getsign.asp",v="http://m.wandaly.net/transportation/gdtrain/Beecloud/getsign.asp",_="",_="m.wandaly.net"==location.hostname?v:m,b=100*f.needPayPrice,y=f.contactName+",预定"+f.orderDetailPassengerVos.length+"张火车票",k=f.partnerOrderNo,w=function(){return p.a.get("http://m.czgdly.com/transportation/gdtrain/beecloud/getCurrentIp.asp")},P=function(e,t,n){return p.a.get(_,{params:{title:e,amount:parseInt(b),orderno:t}})},p.a.all([w(),P(y,k,b)]).then(p.a.spread(function(e,t){g.Indicator.close(),n(function(n){n.$cookie.get("WHERE")&&(n.where=n.$cookie.get("WHERE")),n.paytitle=y,n.mainorderno=f.orderNo,n.price=f.needPayPrice,n.out_trade_no=f.partnerOrderNo,n.sign=t.data,n.guestIp=e.data,n.orderinfo=f,""==n.$cookie.get("WXOPID")&&null==n.$cookie.get("WXOPID")||(n.openid=n.$cookie.get("WXOPID"))})}));case 22:case"end":return t.stop()}},t,h)}))()}},v={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"payinfo"},[n("mt-heard",{attrs:{title:"支付"}}),e._v(" "),n("div",{staticClass:"totlalprice"},[n("p",{staticClass:"price"},[e._v("应付总金额:￥"+e._s(this.price))])]),e._v(" "),e._l(e.passengerInfo,function(t,o){return n("div",{staticClass:"passengerInfo"},[n("div",{staticClass:"left"},[n("p",[e._v(e._s(t.passengerName)+"\n        "),n("span",[e._v(e._s("1"==t.passengerType?"成人票":"儿童票"))])]),e._v(" "),"1"==t.passengerType?n("p",{staticClass:"tip"},[e._v(e._s(e.getIdCardType(t.passengerCardType))+":"+e._s(t.passengerCardNumber))]):e._e()]),e._v(" "),n("div",{staticClass:"right"},[n("p",[e._v(e._s(e.orderBookingPassengerVos[o].seatName+"￥"+e.orderinfo.seatPrice))]),e._v(" "),n("p",{staticClass:"tip"},[e._v(e._s(e.orderBookingPassengerVos[o].seatInfos))])])])}),e._v(" "),e.havinsurance?n("div",{staticClass:"insurance"},[e._v("\n    其他金额:\n    "),n("div",{staticClass:"insurance"},[n("div",{staticClass:"insurance-item"},[n("p",[e._v(e._s(e.orderinfo.orderBookingPassengerVos[0].insuranceVos[0].insuranceName))]),e._v(" "),n("p",[e._v(e._s(e.insurancePrice))])])]),e._v(" "),"4"==e.orderinfo.buyTicketsType||"5"==e.orderinfo.buyTicketsType?n("div",{staticClass:"rushiprice"},[n("span",[e._v("急速抢票套餐")]),e._v(" "),n("span",[e._v("￥15")])]):e._e()]):e._e(),e._v(" "),n("div",{staticClass:"pay"},[n("mt-button",{attrs:{type:"primary",size:"large"},on:{click:e.clickPay}},[e._v("支付")])],1)],2)},staticRenderFns:[]};var _=n("VU/8")(m,v,!1,function(e){n("e39K")},"data-v-30701f70",null).exports,b={name:"login",components:{"mt-field":g.Field,"mt-button":g.Button,"mt-header":g.Header},data:function(){return{logincode:"",contactMobile:"",issended:!1,tttime:-1,loginbuttonenabel:!1,loginbuttonstatus:"",fullPath:"/"}},computed:{loginphonestate:function(){return""==this.contactMobile?"":this.checkPhone(this.contactMobile)?(this.loginbuttonenabel=!1,this.issended=!1,"success"):(this.loginbuttonenabel=!0,this.issended=!0,"error")}},methods:{checkPhone:function(e){return!!/^1[34578]\d{9}$/.test(e)},showTime:function(e){var t=this;this.tttime=e+"秒后重新发送",this.issended=!0,0==e?(this.tttime=-1,this.issended=!1):(e-=1,setTimeout(function(){t.showTime(e)},1e3))},clicklogin:function(){var e=this;this.loginbuttonenabel=!0,this.loginbuttonstatus="登陆中...",p.a.get("http://m.czgdly.com/transportation/gdtrain/Beecloud/login/sendcode.asp",{params:{c:"2",tel:this.contactMobile,name:this.contactName,val:this.logincode}}).then(function(t){"success"==t.data.message?(e.loginbuttonstatus="登陆成功",e.$cookie.set("gdmobileusername",e.contactMobile,7),e.$cookie.set("USERIDGDLY",t.data.data.userid,7),e.$cookie.set("gdmobileuserphone",e.contactMobile,7),e.$cookie.set("usersecret",t.data.data.usersecret,7),setTimeout(function(){e.$router.push(e.fullPath)},1e3)):(e.loginbuttonstatus="验证码不正确",setTimeout(function(){e.loginbuttonstatus="登陆",e.loginbuttonenabel=!1},2e3))}).catch(function(t){e.loginbuttonenabel=!1,e.loginbuttonstatus="登陆"})},clicklogincode:function(){this.showTime(10),p.a.get("http://m.czgdly.com/transportation/gdtrain/Beecloud/login/sendcode.asp",{params:{tel:this.contactMobile,c:"1"}}).then(function(e){}).catch(function(e){})}},beforeRouteEnter:function(e,t,n){n(function(t){t.fullPath=e.fullPath})}},y={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"loginpage"},[n("mt-header",{attrs:{title:"登陆"}}),e._v(" "),n("div",{staticClass:"logingcontent"},[n("div",{staticClass:"user"},[n("mt-field",{attrs:{placeholder:"请输入登陆手机号",state:e.loginphonestate},model:{value:e.contactMobile,callback:function(t){e.contactMobile=t},expression:"contactMobile"}})],1),e._v(" "),n("div",{staticClass:"user"},[n("mt-field",{attrs:{placeholder:"请输入验证码"},model:{value:e.logincode,callback:function(t){e.logincode=t},expression:"logincode"}},[n("mt-button",{attrs:{disabled:e.issended,size:"small",type:"primary"},on:{click:e.clicklogincode}},[e._v(e._s(-1==e.tttime?"发送验证码":e.tttime))])],1)],1),e._v(" "),n("div",{staticClass:"subbutton"},[n("mt-button",{attrs:{size:"large",disabled:e.loginbuttonenabel,type:"primary"},on:{click:e.clicklogin}},[e._v(e._s(""==e.loginbuttonstatus?"登陆":e.loginbuttonstatus))])],1)])],1)},staticRenderFns:[]};var k=n("VU/8")(b,y,!1,function(e){n("G5tF")},null,null).exports;o.default.use(a.a);var w=new a.a({routes:[{path:"/",name:"pay",component:_},{path:"/login",name:"login",component:k}]}),P=n("NYxO");o.default.use(P.a);var I=new P.a.Store({state:{orderprogressstatus:!1,isclear:!1,passengerinfo:[],tripinfo:{havesaved:-1,fromplace:{name:"",code:""},toplace:{name:"",code:""},traveldate:""},count12306:{name:"",password:"",ispassed:-1}},mutations:{hiddenorderprogressbar:function(e,t){e.orderprogressstatus=!1},showorderprogressbar:function(e,t){e.orderprogressstatus=!0},savecount12306:function(e,t){e.count12306=t},savetripinfo:function(e,t){e.tripinfo=t},enableStatus:function(e){e.isclear=!0},addpassenger:function(e,t){e.passengerinfo.push(t)},removepassenger:function(e,t){e.passengerinfo.splice(t,1)},editpassangerInfo:function(e,t,n){e.passengerinfo[t]=n}}}),C=(n("d8/S"),n("K/Lq")),T=n.n(C),V=function(){return-1!=navigator.userAgent.toLowerCase().indexOf("micromessenger")},N=window.location.href,B=0;"m.czgdly.com"==window.location.host||"m.czly001.com"==window.location.host||"jt.czly001.com"==window.location.host?B=0:B=1;var E=function(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.href)||[,""])[1].replace(/\+/g,"%20"))||null};!function(){if(V()){var e=E("openid");if(e&&T.a.set("WXOPID",e,30),!T.a.get("WXOPID"))window.location.href="http://m.czgdly.com/transportation/wxlogin/getcode.asp?fromurl="+encodeURIComponent(N)+"&type="+B}}(),o.default.use(T.a),o.default.use(g.InfiniteScroll),o.default.config.productionTip=!1,w.beforeEach(function(e,t,n){switch(e.path){case"/f":case"/orderdetails":case"/pay":case"/payGradorder":case"/list":case"/reutrnSuccsee":var o=T.a.get("gdmobileuserphone"),s=T.a.get("gdmobileusername"),i=T.a.get("usersecret");null==o||""==o||""==s||null==s||""==i||null==i?(w.push("/login"),f.a.Toast("请先登录")):n();break;default:n()}}),new o.default({el:"#app",router:w,store:I,template:"<App/>",components:{App:i}})},"d8/S":function(e,t){},e39K:function(e,t){},hgYC:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.56e1f11a398f5287728f.js.map